# JobVideo_Platform 使用说明

## 项目简介

基于手机瀑布流短视频的招聘平台，包含后端（FastAPI）和前端（Vue 3）两部分。

## 项目结构

```
JobVideo_Platform/
├── jobvideo_backend/     # 后端服务（FastAPI）
├── jobvideo_frontend/    # 前端应用（Vue 3 + Vite）
├── start.ps1            # Windows 启动脚本
└── 使用说明.md          # 本文档
```

## 环境要求

### 后端要求
- Python 3.8+
- pip
- uvicorn

### 前端要求
- Node.js 16+
- npm

## 快速启动

### 方式一：使用启动脚本（推荐）

直接在项目根目录运行：

```powershell
.\start.ps1
```

脚本会自动启动后端和前端服务。

### 方式二：手动启动

#### 启动后端

```powershell
cd jobvideo_backend
uvicorn app.main:app --reload
```

后端将在 http://127.0.0.1:8000 启动

#### 启动前端（新开一个终端）

```powershell
cd jobvideo_frontend
npm install
npm run dev
```

前端将在 http://localhost:5173 启动

## API 文档

启动后端后，访问以下地址查看 API 文档：

- Swagger UI: http://127.0.0.1:8000/docs
- ReDoc: http://127.0.0.1:8000/redoc

## 核心功能使用

### 1. 用户注册

求职者注册：

```powershell
Invoke-RestMethod -Uri "http://localhost:8000/auth/register" `
  -Method Post `
  -Headers @{ "Content-Type" = "application/json" } `
  -Body '{"username": "alice", "email": "a@x.com", "password": "123456", "role": "seeker"}'
```

企业注册：

```powershell
Invoke-RestMethod -Uri "http://localhost:8000/auth/register" `
  -Method Post `
  -Headers @{ "Content-Type" = "application/json" } `
  -Body '{"username": "billy", "email": "b@x.com", "password": "123456", "role": "employer"}'
```

### 2. 用户登录

```powershell
$response = Invoke-RestMethod -Uri "http://localhost:8000/auth/login" `
  -Method Post `
  -Headers @{ "Content-Type" = "application/json" } `
  -Body '{"username": "alice", "password": "123456"}'

$response.access_token  # 获取访问令牌
```

### 3. 获取用户信息

```powershell
Invoke-RestMethod -Uri "http://localhost:8000/auth/me" `
  -Headers @{ "Authorization" = "Bearer $($response.access_token)" }
```

### 4. 创建职位

```powershell
Invoke-RestMethod -Uri "http://127.0.0.1:8000/jobs/" `
  -Method Post `
  -Headers @{ "Content-Type" = "application/json" } `
  -Body '{"title":"后端工程师", "description":"熟悉 Python", "company":"AI公司", "location":"北京"}'
```

### 5. 获取所有职位

```powershell
Invoke-RestMethod -Uri "http://127.0.0.1:8000/jobs/" -Method Get
```

### 6. 上传视频

```powershell
Invoke-RestMethod -Uri "http://localhost:8000/video/upload" `
  -Method Post `
  -Headers @{ "Authorization" = "Bearer <你的token>" } `
  -Form @{
    "title" = "测试视频"
    "file" = Get-Item "C:\path\to\your\video.mp4"
  }
```

### 7. 获取视频列表

```powershell
Invoke-RestMethod -Uri "http://localhost:8000/video/feed?skip=0&limit=10" -Method Get
```

## 数据库配置

### 默认配置（SQLite）

项目默认使用 SQLite 数据库，无需额外配置，数据库文件会自动创建。

### 使用 PostgreSQL（可选）

如需使用 PostgreSQL，设置环境变量：

```powershell
$env:DATABASE_URL = "postgresql://user:pass@localhost:5432/jobvideo"
uvicorn app.main:app --reload
```

## 常见问题

### Q: PowerShell 执行脚本时报错？
A: 可能需要修改执行策略：
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Q: 前端启动失败？
A: 确保已安装依赖：
```powershell
cd jobvideo_frontend
npm install
```

### Q: 后端启动失败？
A: 确保已安装 Python 依赖：
```powershell
cd jobvideo_backend
pip install fastapi uvicorn sqlalchemy pydantic python-jose[cryptography] passlib[bcrypt] python-multipart
```

### Q: 视频上传失败？
A: 确保 video_storage 目录存在且有写入权限。

## 项目架构

### 后端模块
- `auth/` - 用户认证（注册、登录、JWT）
- `video/` - 视频管理（上传、存储、Feed 流）
- `job/` - 职位管理
- `resume/` - 简历管理
- `company/` - 公司管理

### 前端模块
- `src/api/` - API 调用
- `src/components/` - 组件
- `src/views/` - 页面视图

## 开发说明

### 后端开发
- 代码修改后，uvicorn 会自动重载（--reload 模式）
- API 文档会自动更新

### 前端开发
- 代码修改后，Vite 会自动热更新
- 访问 http://localhost:5173 查看效果

## 技术栈

### 后端
- FastAPI - Web 框架
- SQLAlchemy - ORM
- Pydantic - 数据验证
- JWT - 身份认证

### 前端
- Vue 3 - 前端框架
- Vite - 构建工具
- Axios - HTTP 客户端
