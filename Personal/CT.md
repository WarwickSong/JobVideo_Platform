# CT 物理仿真与质量控制数据生成工具链 
**项目概述**  
CT 物理仿真与质量控制数据生成工具链：基于 CT 成像几何与多能谱物理机制，构建真实感低剂量噪声与多类伪影（含金属/呼吸等）模拟管线，生成训练数据并支撑多类影像质控模型训练与迭代。

**项目要点（细而精，选 4–6 条）**  
- 构建可配置 CT 成像几何模型（Fan-beam）：支持头颅/胸部/低剂量/牙科等预设，统一 `nProj/nu/dso/dde/reso` 等参数，形成标准化几何配置层。  
- 基于 ODL + ASTRA CUDA 实现正/反投影算子与 FBP 重建链路，提供完整“投影 → 重建 → 评价”的仿真闭环。  
- 实现 HU ↔ μ（线性衰减系数）转换与物理一致性约束，确保投影数据符合 Beer–Lambert 定律而非简单图像扰动。  
- 设计多能谱金属伪影模拟：基于能量依赖衰减模型与谱权重混合，引入金属区域投影失真并叠加噪声，生成真实伪影正弦图与重建图。  
- 实现低剂量噪声模型：包含剂量缩放 + 泊松噪声 + 探测器 PSF 模糊 + 角度相关噪声 + 读出噪声 + photon starvation 机制，覆盖多类低质成像退化。  
- 构建数据生成管线：多几何投影空间 + 植入物混合 + 随机增强 + 噪声/伪影切换 + 反投影重建 + 线性插值去金属，形成成套训练样本（GT/Data/LI/Mask）。  
- 量化成果：基于物理实际过程生成完整 CT 低质噪声与伪影影像数据集；训练得到噪声/低质 CT 识别、金属伪影识别与修复、呼吸伪影识别模型，并持续研发运动伪影识别模型。

**关键技术栈（可选一行）**  
Python / ODL / ASTRA CUDA / CT Physics / Multi‑spectral Modeling / FBP / NumPy / SciPy

# CT 模拟与重建系统

## 项目概述
这是一个功能完整的 CT (计算机断层扫描) 模拟与重建系统，用于医学影像研究和算法开发。该系统提供了从 CT 几何参数配置、投影模拟、伪影生成到图像重建的全流程功能，支持多种真实临床场景的模拟。

## 核心功能

### 1. CT 几何系统配置
- **可配置几何参数类** (`CTGeometry`)：支持自定义或选择预设的 CT 系统参数，包括像素分辨率、投影角度、探测器参数等
- **多场景预设**：提供头部、胸部、低剂量胸部和牙科 CT 的专业配置
- **参数转换**：支持物理参数与像素参数的相互转换

### 2. 投影与重建
- **扇形束 CT 射线变换**：基于 ODL 和 ASTRA CUDA 后端实现高效正投影
- **多种重建算法**：支持 FBP (滤波反投影) 和 CGLS (共轭梯度最小二乘) 迭代重建
- **HU 值与线性衰减系数转换**：提供 `hu_to_mu` 和 `mu_to_hu` 函数实现医学影像标准单位转换

### 3. 伪影模拟
- **金属伪影模拟** (`simulate_metal_artifact_multispectral`)：基于多能谱模型模拟金属植入物引起的伪影
- **低剂量噪声模拟** (`add_low_dose_noise`)：模拟不同剂量水平下的量子噪声、系统噪声和 photon starvation 效应
- **运动伪影模拟**：通过投影过程中的运动变换模拟患者运动引起的伪影

### 4. 体模创建与可视化
- **基础几何体生成**：支持创建圆形、椭圆和矩形区域
- **复合体模**：可生成包含身体轮廓和器官的复杂体模
- **对比可视化**：提供直观的原始图像、正弦图和重建结果对比展示

## 技术实现
- **核心库**：PyTorch、ODL、NumPy、ASTRA (CUDA 加速)
- **计算优化**：利用 GPU 加速投影和重建计算
- **模块化设计**：清晰的函数和类结构，便于扩展和集成
- **真实物理模型**：基于 Beer-Lambert 定律和多能谱 X 射线模型

## 应用场景
- **医学影像算法研究**：为 CT 重建算法开发提供标准测试环境
- **低剂量 CT 技术**：评估和优化低辐射剂量下的图像质量
- **伪影校正方法**：为金属和运动伪影校正算法提供测试数据
- **教学与培训**：直观展示 CT 成像原理和各种因素对图像质量的影响

## 技术亮点
- 支持多种临床 CT 系统的真实参数配置
- 实现了多能谱金属伪影的精确模拟
- 提供了真实的低剂量 CT 噪声模型
- 利用 GPU 加速提高计算效率
- 代码结构清晰，注释详尽，便于理解和扩展

这个系统不仅是一个功能完整的 CT 模拟工具，也是医学影像处理和重建算法研究的重要平台，展示了对医学成像物理原理的深入理解和工程实现能力。


# 金属伪影校正数据生成系统

## 项目概述
这是一个专门为 OSCNet（金属伪影校正神经网络）设计的大规模训练数据生成系统，通过物理仿真生成包含各种金属伪影和低剂量噪声的 CT 影像数据集，用于深度学习模型的训练和评估。

## 核心功能

### 1. 多投影空间配置
- **三种 CT 几何配置**：头部 CT、胸部 CT、低剂量胸部 CT，覆盖不同临床场景
- **动态投影空间选择**：支持在多个投影空间间随机切换，增强数据多样性
- **统一接口设计**：封装正投影和反投影操作，简化数据处理流程

### 2. 植入物数据管理
- **双类植入物库**：包含真实植入物（498 层）和合成植入物（90 层）数据
- **智能采样策略**：从两类植入物中不重复随机抽取，确保数据多样性
- **数据增强**：对植入物层进行随机增强（旋转、平移等），模拟不同植入位置和角度

### 3. 多类型伪影模拟系统
设计了 5 种不同的模拟类型，覆盖各种真实临床场景：

- **类型 0**：纯金属伪影（无噪声）
- **类型 1**：金属伪影与低剂量噪声的平均值组合
- **类型 2**：先添加金属伪影，再叠加低剂量噪声（级联效应）
- **类型 3**：仅低剂量噪声（无金属伪影，用于对比学习）
- **类型 4**：无伪影金属与低剂量噪声的平均值组合

### 4. 物理精确的噪声建模
- **多能谱金属伪影**：基于 Beer-Lambert 定律的多能量扩展模型
- **低剂量噪声模拟**：包含量子噪声、系统噪声、角度相关性噪声
- **参数随机化**：剂量、噪声强度、伪影比例等参数在合理范围内随机变化
- **Photon starvation 效应**：模拟高衰减区域的额外噪声增强

### 5. 完整的数据生成流水线
```
GT 影像 → 植入物嵌入 → 正投影 → 伪影/噪声添加 → 反投影重建 → 金属分割 → 线性插值 → 数据集输出
```

### 6. 数据增强与质量控制
- **随机数据增强**：旋转、平移、缩放等变换
- **参数记录**：保存每个样本的生成参数（空间索引、剂量、噪声强度、伪影比例等）
- **可视化验证**：提供 GT、Data、LI、Mask 四图对比展示
- **批量处理**：支持大规模数据集的自动化生成

## 技术亮点

### 1. 物理建模精度
- 严格遵循 CT 成像物理原理（Beer-Lambert 定律）
- 多能谱 X 射线模型准确模拟金属伪影
- 真实的低剂量噪声模型（泊松噪声 + 高斯噪声 + 系统噪声）

### 2. 数据多样性设计
- 多种伪影类型组合，覆盖不同临床场景
- 随机参数化增强数据多样性
- 多投影空间切换提高模型泛化能力

### 3. 工程实现优化
- 模块化设计，易于扩展和维护
- GPU 加速投影和重建计算
- 批量处理支持大规模数据集生成

### 4. 实际应用价值
- 为 OSCNet 提供高质量训练数据
- 支持多种金属伪影校正算法的对比评估
- 可扩展到其他医学影像增强任务

## 应用场景
- **深度学习训练**：为金属伪影校正神经网络提供大规模标注数据
- **算法评估**：通过不同伪影类型评估算法鲁棒性
- **临床研究**：模拟真实临床场景，辅助算法优化
- **数据增强**：用于小样本场景下的数据扩充

## 技术栈
- **核心库**：PyTorch、ODL、NumPy、SciPy
- **CT 仿真**：ASTRA CUDA 加速
- **数据处理**：自定义数据增强和噪声模型
- **可视化**：Matplotlib

## 项目成果
- 生成了包含多种伪影类型的大规模 CT 数据集
- 为 OSCNet 的训练和评估提供了高质量数据支持
- 验证了物理仿真在医学影像数据生成中的有效性

这个项目展示了在医学影像仿真、深度学习数据生成、物理建模和工程实现方面的综合能力，特别是在金属伪影校正这一专业领域的深入理解和实践经验。




